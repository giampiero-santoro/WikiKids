<!-- 
=================================================================
ISTRUZIONI PER WORDPRESS TWENTY TWENTY-FOUR:
=================================================================
1. Vai su "Pagine â†’ Aggiungi nuova"
2. Clicca sui tre puntini in alto a destra
3. Seleziona "Modifica come HTML" o "Editor di codice"
4. Copia e incolla TUTTO questo codice
5. Torna alla modalitÃ  visuale se vuoi
6. Pubblica!

NOTA: Il titolo della pagina lo puoi impostare nel campo "Titolo pagina" di WordPress
=================================================================
-->

<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@600;700&family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">

<style>
    /* Scoped styles per compatibilitÃ  WordPress */
    .apparato-container {
        font-family: 'Quicksand', sans-serif;
        position: relative;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 40px 20px;
        border-radius: 20px;
        margin: 40px auto;
        max-width: 100%;
        overflow: hidden;
    }

    .apparato-container * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .apparato-container {
        --primary: #FF6B6B;
        --secondary: #4ECDC4;
        --accent: #FFE66D;
        --purple: #A8E6CF;
        --orange: #FFB347;
    }

    /* Animated background bubbles */
    .apparato-container .bubble {
        position: absolute;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        animation: app-float 8s infinite ease-in-out;
        pointer-events: none;
        z-index: 0;
    }

    @keyframes app-float {
        0%, 100% { transform: translateY(0) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(180deg); }
    }

    .apparato-container .inner-container {
        max-width: 1200px;
        margin: 0 auto;
        position: relative;
        z-index: 1;
    }

    .apparato-container header {
        text-align: center;
        padding: 40px 20px;
        background: linear-gradient(135deg, var(--primary), var(--orange));
        border-radius: 30px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        margin-bottom: 40px;
        animation: app-slideDown 1s ease-out;
    }

    @keyframes app-slideDown {
        from { transform: translateY(-100px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }

    .apparato-container h1 {
        font-family: 'Fredoka', sans-serif;
        font-size: 3rem;
        font-weight: 700;
        color: white !important;
        text-shadow: 4px 4px 0 rgba(0,0,0,0.3);
        letter-spacing: 2px;
        margin-bottom: 10px !important;
    }

    .apparato-container .subtitle {
        font-size: 1.5rem;
        color: var(--accent);
        font-weight: 700;
    }

    .apparato-container .tabs {
        display: flex;
        gap: 15px;
        margin-bottom: 30px;
        flex-wrap: wrap;
        justify-content: center;
    }

    .apparato-container .tab {
        padding: 15px 30px;
        background: white;
        border: none;
        border-radius: 20px;
        font-family: 'Quicksand', sans-serif;
        font-weight: 700;
        font-size: 1.1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .apparato-container .tab:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    }

    .apparato-container .tab.active {
        background: linear-gradient(135deg, var(--secondary), var(--purple));
        color: white;
        transform: scale(1.1);
    }

    .apparato-container .content {
        display: none;
        animation: app-fadeIn 0.5s ease-in;
    }

    .apparato-container .content.active {
        display: block;
    }

    @keyframes app-fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .apparato-container .card {
        background: white;
        border-radius: 25px;
        padding: 30px;
        margin-bottom: 25px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        transition: transform 0.3s ease;
    }

    .apparato-container .card:hover {
        transform: translateY(-5px);
    }

    .apparato-container .card h2 {
        font-family: 'Fredoka', sans-serif;
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--primary) !important;
        margin-bottom: 20px !important;
        text-shadow: 2px 2px 0 rgba(0,0,0,0.1);
    }

    .apparato-container .card h3 {
        font-size: 1.8rem;
        color: var(--secondary) !important;
        margin: 20px 0 10px 0 !important;
        font-weight: 700;
    }

    .apparato-container .card p {
        font-size: 1.2rem;
        line-height: 1.8;
        color: #333;
        margin-bottom: 15px;
    }

    /* Interactive digestive system */
    .apparato-container .digestive-system {
        position: relative;
        height: 800px;
        background: linear-gradient(180deg, #FFE5E5 0%, #FFF8DC 100%);
        border-radius: 25px;
        padding: 30px;
        margin: 30px 0;
    }

    .apparato-container .organ {
        position: absolute;
        cursor: pointer;
        transition: all 0.3s ease;
        padding: 15px;
        border-radius: 15px;
        background: rgba(255,255,255,0.9);
        border: 3px solid transparent;
        font-weight: 700;
    }

    .apparato-container .organ:hover {
        transform: scale(1.1);
        border-color: var(--primary);
        box-shadow: 0 10px 30px rgba(255, 107, 107, 0.5);
        z-index: 10;
    }

    .apparato-container .organ.clicked {
        background: var(--accent);
        animation: app-bounce 0.5s ease;
    }

    @keyframes app-bounce {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.2); }
    }

    .apparato-container .mouth { top: 50px; left: 50%; transform: translateX(-50%); background: #FFB6C1; }
    .apparato-container .esophagus { top: 150px; left: 50%; transform: translateX(-50%); background: #DDA0DD; }
    .apparato-container .stomach { top: 280px; left: 45%; background: #FF6B9D; }
    .apparato-container .small-intestine { top: 420px; left: 30%; background: #98D8C8; }
    .apparato-container .large-intestine { top: 580px; left: 50%; background: #F7DC6F; }

    .apparato-container .info-box {
        position: absolute;
        background: white;
        border: 4px solid var(--primary);
        border-radius: 20px;
        padding: 20px;
        max-width: 350px;
        display: none;
        box-shadow: 0 15px 50px rgba(0,0,0,0.3);
        z-index: 100;
        animation: app-popIn 0.3s ease;
    }

    @keyframes app-popIn {
        from { transform: scale(0); }
        to { transform: scale(1); }
    }

    .apparato-container .info-box.show {
        display: block;
    }

    .apparato-container .info-box h4 {
        font-family: 'Fredoka', sans-serif;
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--primary) !important;
        margin-bottom: 10px !important;
    }

    .apparato-container .info-box p {
        font-size: 1rem;
        margin: 5px 0;
    }

    /* Quiz section */
    .apparato-container .quiz-container {
        background: linear-gradient(135deg, var(--purple), var(--secondary));
        padding: 40px;
        border-radius: 25px;
        color: white;
    }

    .apparato-container .quiz-question {
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 25px;
    }

    .apparato-container .quiz-options {
        display: grid;
        gap: 15px;
    }

    .apparato-container .quiz-option {
        background: white;
        color: #333;
        padding: 20px;
        border-radius: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1.2rem;
        font-weight: 600;
        border: 3px solid transparent;
    }

    .apparato-container .quiz-option:hover {
        transform: translateX(10px);
        border-color: var(--accent);
    }

    .apparato-container .quiz-option.correct {
        background: #4CAF50;
        color: white;
        animation: app-celebrate 0.6s ease;
    }

    .apparato-container .quiz-option.wrong {
        background: #F44336;
        color: white;
        animation: app-shake 0.5s ease;
    }

    @keyframes app-celebrate {
        0%, 100% { transform: rotate(0deg); }
        25% { transform: rotate(-5deg); }
        75% { transform: rotate(5deg); }
    }

    @keyframes app-shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-10px); }
        75% { transform: translateX(10px); }
    }

    .apparato-container .score {
        text-align: center;
        font-size: 2rem;
        margin-top: 20px;
        font-weight: 700;
    }

    .apparato-container .fun-fact {
        background: linear-gradient(135deg, var(--orange), var(--primary));
        color: white;
        padding: 25px;
        border-radius: 20px;
        margin: 20px 0;
        border-left: 8px solid var(--accent);
        font-size: 1.2rem;
        font-weight: 600;
    }

    .apparato-container .fun-fact::before {
        content: "ğŸ’¡ Lo sapevi?";
        display: block;
        font-family: 'Fredoka', sans-serif;
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 10px;
    }

    /* Memory game */
    .apparato-container .memory-game {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 15px;
        padding: 30px;
        background: white;
        border-radius: 25px;
    }

    .apparato-container .memory-card {
        aspect-ratio: 1;
        background: linear-gradient(135deg, var(--secondary), var(--purple));
        border-radius: 15px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3rem;
        transition: transform 0.3s ease;
        transform-style: preserve-3d;
        position: relative;
    }

    .apparato-container .memory-card:hover {
        transform: scale(1.05);
    }

    .apparato-container .memory-card.flipped {
        transform: rotateY(180deg);
    }

    .apparato-container .memory-card .front,
    .apparato-container .memory-card .back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 15px;
    }

    .apparato-container .memory-card .back {
        background: white;
        transform: rotateY(180deg);
    }

    .apparato-container button {
        background: linear-gradient(135deg, var(--primary), var(--orange));
        color: white;
        border: none;
        padding: 15px 30px;
        font-size: 1.2rem;
        font-weight: 700;
        border-radius: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        font-family: 'Quicksand', sans-serif;
    }

    .apparato-container button:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.4);
    }

    .apparato-container .congrats {
        text-align: center;
        font-size: 3rem;
        color: var(--accent);
        margin: 30px 0;
        animation: app-rainbow 3s infinite;
    }

    @keyframes app-rainbow {
        0% { color: #FF6B6B; }
        25% { color: #4ECDC4; }
        50% { color: #FFE66D; }
        75% { color: #A8E6CF; }
        100% { color: #FF6B6B; }
    }

    .apparato-container footer {
        text-align: center;
        padding: 30px 20px;
        margin-top: 50px;
        background: rgba(255,255,255,0.1);
        border-radius: 20px;
        color: white;
        font-size: 0.9rem;
    }

    .apparato-container footer p {
        margin-bottom: 10px;
        color: white !important;
    }

    .apparato-container footer a {
        color: var(--accent);
        text-decoration: none;
        font-weight: 700;
    }

    .apparato-container textarea {
        width: 100%;
        height: 150px;
        font-size: 1.2rem;
        padding: 15px;
        border-radius: 15px;
        border: 3px solid var(--secondary);
        font-family: 'Quicksand', sans-serif;
    }

    @media (max-width: 768px) {
        .apparato-container h1 { font-size: 2.5rem !important; }
        .apparato-container .subtitle { font-size: 1.2rem; }
        .apparato-container .digestive-system { height: 600px; }
        .apparato-container .memory-game { grid-template-columns: repeat(3, 1fr); }
        .apparato-container .card h2 { font-size: 2rem !important; }
        .apparato-container .card h3 { font-size: 1.5rem !important; }
    }
</style>

<div class="apparato-container">
    <!-- Animated background bubbles -->
    <div class="bubble" style="width: 100px; height: 100px; top: 10%; left: 10%;"></div>
    <div class="bubble" style="width: 150px; height: 150px; top: 60%; left: 80%; animation-delay: 2s;"></div>
    <div class="bubble" style="width: 80px; height: 80px; top: 80%; left: 20%; animation-delay: 4s;"></div>
    <div class="bubble" style="width: 120px; height: 120px; top: 30%; left: 70%; animation-delay: 1s;"></div>

    <div class="inner-container">
        <header>
            <h1>ğŸ• L'AVVENTURA DEL CIBO! ğŸ”</h1>
            <p class="subtitle">Scopri il fantastico viaggio che fa il cibo nel tuo corpo!</p>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="apparatoShowTab('impara', event)">ğŸ“š Impara</button>
            <button class="tab" onclick="apparatoShowTab('esplora', event)">ğŸ” Esplora</button>
            <button class="tab" onclick="apparatoShowTab('quiz', event)">ğŸ¯ Quiz</button>
            <button class="tab" onclick="apparatoShowTab('gioca', event)">ğŸ® Gioca</button>
        </div>

        <!-- Tab 1: Impara -->
        <div id="app-impara" class="content active">
            <div class="card">
                <h2>ğŸ¢ Il Viaggio Incredibile del Cibo!</h2>
                <p>Ogni volta che mangi una pizza, un panino o una mela, il cibo fa un viaggio fantastico dentro il tuo corpo! Questo viaggio puÃ² durare anche 2-3 giorni! Vediamo insieme tutte le fermate...</p>
            </div>

            <div class="card">
                <h3>1. ğŸ‘„ LA BOCCA - La Prima Fermata!</h3>
                <p>Qui inizia tutto! I tuoi denti sono come piccoli trituratori che sminuzzano il cibo. La lingua lo mescola con la saliva (una specie di acqua speciale) che lo rende piÃ¹ morbido. Quando Ã¨ pronto, diventa una pallina morbida chiamata <strong>BOLO</strong> - che nome buffo, vero?</p>
                <div class="fun-fact">
                    Ogni giorno produci circa 1 litro di saliva! Ãˆ come una piccola bottiglia d'acqua! ğŸ’§
                </div>
            </div>

            <div class="card">
                <h3>2. ğŸª L'ESOFAGO - Il Tunnel Magico</h3>
                <p>L'esofago Ã¨ un tubo lungo circa 24 cm (come un righello!) che porta il cibo dalla bocca allo stomaco. Ãˆ talmente forte che potresti mangiare anche a testa in giÃ¹ e il cibo arriverebbe comunque giÃ¹! Come fa? Usa dei movimenti speciali chiamati <strong>peristalsi</strong> - come onde che spingono il cibo!</p>
                <div class="fun-fact">
                    Il cibo impiega solo 6-8 secondi per scivolare dall'esofago allo stomaco! Ãˆ velocissimo! âš¡
                </div>
            </div>

            <div class="card">
                <h3>3. ğŸ«— LO STOMACO - Il Laboratorio Chimico</h3>
                <p>Lo stomaco Ã¨ come un sacchetto elastico che puÃ² contenere fino a 2 litri di cibo! Qui il cibo viene mescolato con i <strong>succhi gastrici</strong> - liquidi speciali che lo scompongono. Ci sono enzimi come la <strong>pepsina</strong> che rompono le proteine e l'acido cloridrico che uccide i batteri cattivi. Il cibo rimane qui per 2-4 ore e diventa una pappa chiamata <strong>CHIMO</strong>.</p>
                <div class="fun-fact">
                    Il tuo stomaco ha una temperatura di 37Â°C (come la febbre!) e l'aciditÃ  Ã¨ fortissima - ma non ti fa male perchÃ© Ã¨ protetto da uno strato di muco! ğŸ›¡ï¸
                </div>
            </div>

            <div class="card">
                <h3>4. ğŸŒ€ L'INTESTINO TENUE - La Strada Lunga</h3>
                <p>Questo Ã¨ il pezzo piÃ¹ lungo! Ãˆ lungo piÃ¹ di 7 metri (come 3 persone sdraiate una dopo l'altra!). Qui arrivano aiuti speciali:</p>
                <p>ğŸŸ¡ <strong>La BILE</strong> dal fegato - che rende i grassi piÃ¹ piccoli</p>
                <p>ğŸ”µ <strong>Il SUCCO PANCREATICO</strong> - pieno di enzimi super potenti</p>
                <p>ğŸŸ¢ <strong>Il SUCCO ENTERICO</strong> - che finisce il lavoro</p>
                <p>Qui tutte le sostanze buone (vitamine, proteine, zuccheri) vengono assorbite e vanno nel sangue per dare energia a tutto il corpo! Le pareti sono piene di piccoli "diti" chiamati <strong>villi intestinali</strong> che catturano i nutrienti.</p>
                <div class="fun-fact">
                    Se stirassimo tutti i villi intestinali, coprirebbero un campo da tennis! ğŸ¾
                </div>
            </div>

            <div class="card">
                <h3>5. ğŸ’© L'INTESTINO CRASSO - L'Ultima Fermata</h3>
                <p>Lungo circa 2 metri, questo pezzo dell'intestino recupera l'acqua e prepara quello che non serve piÃ¹ per uscire. Qui vivono miliardi di batteri buoni che ci aiutano! Alla fine, quello che resta diventa <strong>FECI</strong> (cacca) e viene eliminato dal corpo attraverso l'ano.</p>
                <div class="fun-fact">
                    Nel tuo intestino vivono piÃ¹ batteri buoni di quante persone ci sono sulla Terra! Sono i tuoi amici microscopici! ğŸ¦ 
                </div>
            </div>

            <div class="card">
                <h2>â±ï¸ Tempo Totale del Viaggio</h2>
                <p>Dal momento in cui mangi una mela fino a quando esce dalla "porta di uscita", passano dalle 24 alle 72 ore! Questo significa che quel panino che hai mangiato a colazione potrebbe ancora essere dentro di te domani!</p>
            </div>
        </div>

        <!-- Tab 2: Esplora -->
        <div id="app-esplora" class="content">
            <div class="card">
                <h2>ğŸ” Esplora l'Apparato Digerente!</h2>
                <p>Clicca su ogni organo per scoprire i suoi segreti!</p>
                
                <div class="digestive-system">
                    <div class="organ mouth" onclick="apparatoShowInfo('mouth', event)">
                        ğŸ‘„ BOCCA
                    </div>
                    <div class="organ esophagus" onclick="apparatoShowInfo('esophagus', event)">
                        ğŸª ESOFAGO
                    </div>
                    <div class="organ stomach" onclick="apparatoShowInfo('stomach', event)">
                        ğŸ«— STOMACO
                    </div>
                    <div class="organ small-intestine" onclick="apparatoShowInfo('small', event)">
                        ğŸŒ€ INTESTINO TENUE
                    </div>
                    <div class="organ large-intestine" onclick="apparatoShowInfo('large', event)">
                        ğŸ’© INTESTINO CRASSO
                    </div>

                    <!-- Info boxes -->
                    <div id="app-info-mouth" class="info-box" style="top: 50px; right: 50px;">
                        <h4>ğŸ‘„ LA BOCCA</h4>
                        <p>ğŸ¦· 32 denti ti aiutano a masticare</p>
                        <p>ğŸ‘… La lingua mescola il cibo</p>
                        <p>ğŸ’§ La saliva rende tutto morbido</p>
                        <p>ğŸ¯ Tempo: 15-30 secondi</p>
                    </div>

                    <div id="app-info-esophagus" class="info-box" style="top: 150px; right: 50px;">
                        <h4>ğŸª L'ESOFAGO</h4>
                        <p>ğŸ“ Lungo 24 cm</p>
                        <p>ğŸŒŠ Usa la peristalsi per spingere</p>
                        <p>âš¡ VelocitÃ : 6-8 secondi</p>
                        <p>ğŸ¢ Puoi mangiare a testa in giÃ¹!</p>
                    </div>

                    <div id="app-info-stomach" class="info-box" style="top: 300px; right: 50px;">
                        <h4>ğŸ«— LO STOMACO</h4>
                        <p>ğŸŒ¡ï¸ Temperatura: 37Â°C</p>
                        <p>âš—ï¸ pH 3.5 (molto acido!)</p>
                        <p>â° Il cibo resta 2-4 ore</p>
                        <p>ğŸ§ª Produce 2 litri di succhi al giorno</p>
                    </div>

                    <div id="app-info-small" class="info-box" style="top: 420px; right: 50px;">
                        <h4>ğŸŒ€ INTESTINO TENUE</h4>
                        <p>ğŸ“ Lunghezza: 7 metri!</p>
                        <p>ğŸ¯ Assorbe 90% dei nutrienti</p>
                        <p>ğŸ‘† Pieno di villi intestinali</p>
                        <p>â±ï¸ Il cibo resta 3-5 ore</p>
                    </div>

                    <div id="app-info-large" class="info-box" style="top: 580px; right: 50px;">
                        <h4>ğŸ’© INTESTINO CRASSO</h4>
                        <p>ğŸ“ Lunghezza: 2 metri</p>
                        <p>ğŸ’§ Recupera l'acqua</p>
                        <p>ğŸ¦  Casa di miliardi di batteri buoni</p>
                        <p>â° Il cibo resta 12-48 ore</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 3: Quiz -->
        <div id="app-quiz" class="content">
            <div class="card">
                <div class="quiz-container">
                    <h2 style="color: white; margin-bottom: 30px;">ğŸ¯ Metti alla Prova le Tue Conoscenze!</h2>
                    
                    <div id="app-quiz-content">
                        <div class="quiz-question" id="app-question"></div>
                        <div class="quiz-options" id="app-options"></div>
                    </div>

                    <div class="score" id="app-score">Punteggio: 0/0</div>
                    <button onclick="apparatoResetQuiz()">ğŸ”„ Ricomincia Quiz</button>
                </div>
            </div>
        </div>

        <!-- Tab 4: Gioca -->
        <div id="app-gioca" class="content">
            <div class="card">
                <h2>ğŸ® Memory Game - Trova le Coppie!</h2>
                <p>Trova le coppie di organi uguali! Clicca su due carte per girarle.</p>
                
                <div class="memory-game" id="app-memory-game"></div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button onclick="apparatoInitMemoryGame()">ğŸ”„ Nuova Partita</button>
                    <div id="app-moves" style="margin-top: 15px; font-size: 1.5rem; font-weight: 700;">Mosse: 0</div>
                </div>
            </div>

            <div class="card" style="margin-top: 30px;">
                <h2>ğŸ¨ Colora e Impara!</h2>
                <p>Sai nominare tutti gli organi? Scrivi qui sotto cosa hai imparato oggi!</p>
                <textarea placeholder="Scrivi qui la cosa piÃ¹ interessante che hai imparato oggi sull'apparato digerente! ğŸ‰"></textarea>
            </div>
        </div>

        <footer>
            <p>ğŸ“š Informazioni scientifiche basate su contenuti di <a href="https://it.wikipedia.org/wiki/Apparato_digerente" target="_blank">Wikipedia</a></p>
            <p style="font-size: 0.8rem; opacity: 0.8;">Contenuti rilasciati sotto licenza Creative Commons Attribution-ShareAlike 3.0</p>
            <p style="margin-top: 15px; font-size: 1.2rem;">ğŸ’¡ Creato per imparare divertendosi! ğŸ‰</p>
        </footer>
    </div>
</div>

<script>
    // Namespace tutte le funzioni per evitare conflitti con WordPress
    (function() {
        // Tab switching
        window.apparatoShowTab = function(tabName, event) {
            const container = document.querySelector('.apparato-container');
            const tabs = container.querySelectorAll('.tab');
            const contents = container.querySelectorAll('.content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            container.querySelector('#app-' + tabName).classList.add('active');
        };

        // Explore section
        let currentInfo = null;
        
        window.apparatoShowInfo = function(organId, event) {
            const container = document.querySelector('.apparato-container');
            const infoBox = container.querySelector('#app-info-' + organId);
            const organ = event.target;
            
            if (currentInfo && currentInfo !== infoBox) {
                currentInfo.classList.remove('show');
            }
            
            if (infoBox.classList.contains('show')) {
                infoBox.classList.remove('show');
                currentInfo = null;
            } else {
                infoBox.classList.add('show');
                organ.classList.add('clicked');
                setTimeout(() => organ.classList.remove('clicked'), 500);
                currentInfo = infoBox;
            }
        };

        // Quiz section
        const quizQuestions = [
            {
                question: "Come si chiama la pallina di cibo che si forma in bocca?",
                options: ["Bolo", "Chimo", "Pizza", "Pallina magica"],
                correct: 0
            },
            {
                question: "Quanto Ã¨ lungo l'intestino tenue?",
                options: ["1 metro", "3 metri", "PiÃ¹ di 7 metri", "100 metri"],
                correct: 2
            },
            {
                question: "Quanto tempo impiega il cibo per attraversare l'esofago?",
                options: ["1 minuto", "6-8 secondi", "1 ora", "5 minuti"],
                correct: 1
            },
            {
                question: "Qual Ã¨ la temperatura dello stomaco?",
                options: ["20Â°C", "50Â°C", "37Â°C", "100Â°C"],
                correct: 2
            },
            {
                question: "Cosa fa la bile?",
                options: ["Rende i grassi piÃ¹ piccoli", "Fa ridere", "Colora il cibo", "Lo rende dolce"],
                correct: 0
            },
            {
                question: "Quanta saliva produci ogni giorno?",
                options: ["1 cucchiaio", "1 litro", "10 litri", "Niente"],
                correct: 1
            },
            {
                question: "Come si chiamano i piccoli 'diti' nell'intestino tenue?",
                options: ["Ditini", "Villi intestinali", "Peli magici", "Antenne"],
                correct: 1
            },
            {
                question: "Quanto tempo resta il cibo nello stomaco?",
                options: ["5 minuti", "10 ore", "2-4 ore", "2 giorni"],
                correct: 2
            }
        ];

        let currentQuestion = 0;
        let score = 0;

        function loadQuestion() {
            const container = document.querySelector('.apparato-container');
            
            if (currentQuestion >= quizQuestions.length) {
                showQuizResults();
                return;
            }

            const q = quizQuestions[currentQuestion];
            container.querySelector('#app-question').textContent = q.question;
            
            const optionsDiv = container.querySelector('#app-options');
            optionsDiv.innerHTML = '';
            
            q.options.forEach((option, index) => {
                const btn = document.createElement('div');
                btn.className = 'quiz-option';
                btn.textContent = option;
                btn.onclick = () => checkAnswer(index);
                optionsDiv.appendChild(btn);
            });

            updateScore();
        }

        function checkAnswer(selected) {
            const container = document.querySelector('.apparato-container');
            const q = quizQuestions[currentQuestion];
            const options = container.querySelectorAll('.quiz-option');
            
            if (selected === q.correct) {
                options[selected].classList.add('correct');
                score++;
                setTimeout(() => {
                    currentQuestion++;
                    loadQuestion();
                }, 1500);
            } else {
                options[selected].classList.add('wrong');
                options[q.correct].classList.add('correct');
                setTimeout(() => {
                    currentQuestion++;
                    loadQuestion();
                }, 2000);
            }
        }

        function updateScore() {
            const container = document.querySelector('.apparato-container');
            container.querySelector('#app-score').textContent = `Punteggio: ${score}/${currentQuestion}`;
        }

        function showQuizResults() {
            const container = document.querySelector('.apparato-container');
            const percentage = (score / quizQuestions.length) * 100;
            let message = '';
            
            if (percentage === 100) {
                message = 'ğŸ† PERFETTO! Sei un genio dell\'apparato digerente! ğŸŒŸ';
            } else if (percentage >= 70) {
                message = 'ğŸ‰ Bravissimo! Hai imparato tantissimo! ğŸ‘';
            } else if (percentage >= 50) {
                message = 'ğŸ˜Š Buon lavoro! Continua a studiare! ğŸ“š';
            } else {
                message = 'ğŸ’ª Dai, riprova! Diventerai un esperto! ğŸš€';
            }

            container.querySelector('#app-quiz-content').innerHTML = `
                <div style="text-align: center;">
                    <h2 class="congrats">${message}</h2>
                    <p style="font-size: 2.5rem; margin: 30px 0;">
                        Hai risposto correttamente a ${score} domande su ${quizQuestions.length}!
                    </p>
                    <p style="font-size: 3rem;">${percentage >= 70 ? 'ğŸŠğŸ‰ğŸˆ' : 'ğŸ“–ğŸ’¡ğŸ§ '}</p>
                </div>
            `;
        }

        window.apparatoResetQuiz = function() {
            const container = document.querySelector('.apparato-container');
            currentQuestion = 0;
            score = 0;
            container.querySelector('#app-quiz-content').innerHTML = `
                <div class="quiz-question" id="app-question"></div>
                <div class="quiz-options" id="app-options"></div>
            `;
            loadQuestion();
        };

        // Memory Game
        const memoryCards = ['ğŸ‘„', 'ğŸ«—', 'ğŸŒ€', 'ğŸ’©', 'ğŸ¦·', 'ğŸ§ª', 'ğŸ¯', 'âš¡'];
        let memoryGameCards = [...memoryCards, ...memoryCards];
        let flippedCards = [];
        let matchedPairs = 0;
        let moves = 0;

        window.apparatoInitMemoryGame = function() {
            const container = document.querySelector('.apparato-container');
            matchedPairs = 0;
            moves = 0;
            flippedCards = [];
            memoryGameCards = [...memoryCards, ...memoryCards].sort(() => Math.random() - 0.5);
            
            const gameDiv = container.querySelector('#app-memory-game');
            gameDiv.innerHTML = '';
            
            memoryGameCards.forEach((emoji, index) => {
                const card = document.createElement('div');
                card.className = 'memory-card';
                card.innerHTML = `
                    <div class="front">â“</div>
                    <div class="back">${emoji}</div>
                `;
                card.dataset.index = index;
                card.dataset.emoji = emoji;
                card.onclick = flipCard;
                gameDiv.appendChild(card);
            });

            container.querySelector('#app-moves').textContent = 'Mosse: 0';
        };

        function flipCard() {
            const container = document.querySelector('.apparato-container');
            
            if (flippedCards.length === 2) return;
            if (this.classList.contains('flipped')) return;

            this.classList.add('flipped');
            flippedCards.push(this);

            if (flippedCards.length === 2) {
                moves++;
                container.querySelector('#app-moves').textContent = `Mosse: ${moves}`;
                checkMatch();
            }
        }

        function checkMatch() {
            const [card1, card2] = flippedCards;
            
            if (card1.dataset.emoji === card2.dataset.emoji) {
                matchedPairs++;
                flippedCards = [];
                
                if (matchedPairs === memoryCards.length) {
                    setTimeout(() => {
                        alert(`ğŸ‰ HAI VINTO! Hai completato il gioco in ${moves} mosse! ğŸ†`);
                    }, 500);
                }
            } else {
                setTimeout(() => {
                    card1.classList.remove('flipped');
                    card2.classList.remove('flipped');
                    flippedCards = [];
                }, 1000);
            }
        }

        // Initialize on load
        loadQuestion();
        apparatoInitMemoryGame();
    })();
</script>
